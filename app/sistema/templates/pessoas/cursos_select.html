<style>
    .dropdown input {
        outline: none;
        border: none;
    }
    .dropdown input:focus {
        outline: none;
        border: none;
    }

    .dflex {
        display: flex;
    }

    .border {
        border: 1px solid black;
    }

    /* The container <div> - needed to position the dropdown content */
    .dropdown {
        position: relative;
        display: inline-block;
        padding: 4px 2px;
        border: 2px solid #d1d3e2;
        border-radius: 4px;
    }

    /* Dropdown Content (Hidden by Default) */
    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f9f9f9;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        z-index: 1;
    }
    
    .dropdown-inputed-item {
        position: relative;
        display: inline-block;
        padding: 2px 8px;
        border: 1px solid #ccc;
        border-radius: 8px;

    }

    .dropdown-input {
        border: 2px solid #ccc;
        border-left: none;
    }

    .btn-delete-checkbox-selection {
        position: absolute;
        top: 0;
        right: 0;
        border: none;
        width: 100%;
        height: 100%;
        font-size: 12px;
        background-color: transparent;
        color: transparent;
        border-radius: 8px;
    }

    .show-on-viewport {
        position: fixed;
        bottom: 0px;
        right: 20px;
    }

    .dropdown-inputed-container {
        height: 40px;
        display: flex;
        justify-content: start;
    }

    .dropdown-inputed-container::-webkit-scrollbar {
        height: 5px;
        background: gray;
    }
</style>
<label><b>Cursos:</b></label>
<div id="inputedValues" class="dropdown-inputed-container" style="max-width: 300px;" hidden></div>
<div id="dropdown-cursos">
    <div class="dropdown">
        <div class="dflex felx-row">
            <input id="dropdowninput" class="dropdown-input" placeholder="selecione os cursos" type="text">
        </div>
        <div class="dropdown-content">
            {% for curso in cursos %}
            <div id="checkboxCursoContainer{{curso.id}}">
                <input id="checkboxCursoInput{{curso.id}}" type="checkbox" name="cursos" value="{{curso.id}}">
                <span id="checkboxCursoText{{curso.id}}">{{curso.nome}}</span>    
            </div>   
            {% endfor %}     
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        function filterElements() {
            let input = $("#dropdowninput");
            let filter = input.val().toUpperCase();
            let inputedElements = $("div[id^='checkboxCursoContainer']");
            inputedElements.each(function() {
                textContent = $(this).children("span[id^='checkboxCursoText']").text()
                if (textContent.toUpperCase().indexOf(filter) > -1) {
                    $(this).show();
                } else {
                    $(this).hide();
                }
            });
        }

        function onclickElementOutside(element, callback) {
            $(document).on('click', function (e) {
                if (!$(element).is(e.target) && $(element).has(e.target).length === 0) {
                    callback();
                }
            });
        }

        cursosCheckbox = $("input[name='cursos']")
        cursosCheckbox.each(function(i, el) {
            $(el).on('click', function() {
                if ($(el).is(':checked')) {
                    let valueId = $(el).val()
                    let div = $('<div />').attr({
                        'class':'dropdown-inputed-item', 
                        'id': 'dropdownInputedItem' + valueId});
                    let span = $('<span />')
                    let spanTextValueId = "#checkboxCursoText"+valueId  
                    let spanTextValue = $(spanTextValueId).text() 
                    span.css("white-space", "nowrap")
                    span.text(spanTextValue)
                    div.append(span)
                    let btnRemove = $('<button />').attr({
                        'class':'btn-delete-checkbox-selection', 
                        'type': 'button',
                        'id': 'btnRemove' + valueId});
                    btnRemove.text("x")
                    btnRemove.hover(function() {
                        $(this).css("background-color", "rgba(255, 0, 0, 0.3)")
                        div.css("text-decoration", "line-through")
                    }, function() {
                        $(this).css("background-color", "transparent")
                        div.css("text-decoration", "none")
                    })
                    btnRemove.on('click', function() {
                        $(el).prop('checked', false);
                        div.remove();
                    })
                    div.append(btnRemove)
                    $("#inputedValues").append(div)
                    
                } else {
                    let valueId = $(el).val()
                    $("#dropdownInputedItem" + valueId).remove()
                }
            });

        })
        $("#dropdowninput").on('keyup', function() {
            filterElements()
        });

        $("#dropdowninput").focus(function() {
            $(".dropdown-content").toggle();
        });

        onclickElementOutside(".dropdown", function() {
            $(".dropdown-content").hide();
        });

        // $("#"+formId).submit(function(event) {
        //     event.preventDefault();
        //     let values = [] 
        //     cursosCheckbox.each(function(i, el) {
        //         if ($(this).is(":checked")) {values.push($(this).val())}
        //     })
        //     console.log(values);
        // });

        
    });
</script>